         /*?????J^           :J?????????????7!^.      .J???????????????????    ^J???????????????????
        P@@@@@@@@@!          ?@@@@@@@@@@@@@@@@@@&Y.   ^@@@@@@@@@@@@@@@@@@@@.   G@@@@@@@@@@@@@@@@@@@@
       G@@@@@@@@@@@7         7@@@@@@@&&&&&&@@@@@@@@:  ^@@@@@@@&&&&&&&&&&&&&    G@@@?:::^G@@Y:::^B@@@
      G@@@@@@B@@@@@@?        7@@@@@@&      .&@@@@@@P  ^@@@@@@@~~~~~~~~~~.      G@@@@5.   ^:   !&@@@@
     B@@@@@@^ P@@@@@@J       7@@@@@@&^^^^^^?@@@@@@@7  ^@@@@@@@@@@@@@@@@@?      G@@@@@@J     :&@@@@@@
    #@@@@@@G^^~&@@@@@@Y      7@@@@@@@@@@@@@@@@@@@@?   ^@@@@@@@&&&&&&&&&&~      G@@@@@#^      Y@@@@@@
   #@@@@@@@@@@@@@@@@@@@5     7@@@@@@@&&&&&&&&#GY~     ^@@@@@@&^^^^^^^^^^^:^    G@@@#^   :G^    Y@@@@
 .&@@@@@@&#######&@@@@@@P    7@@@@@@&                 ^@@@@@@@@@@@@@@@@@@@@~   G@@&?7?7P@@@G7?77G@@@
.&@@@@@@J         #@@@@@@G   7@@@@@@&                 ^@@@@@@@@@@@@@@@@@@@@~   P@@@@@@@@@@@@@@@@@@@@
.:......           ......:    .......                  ....................    .....................


                                     .^~?YPGB#&&@@@@&&#BGPY?!^.                       
                                 :!YG#&@@@@@@@@@@@@@@@@@@@@@@&#GY!:                   
                             .~YB&@@@@@@@@@@@@@&&&&&&@@@@@@@@@@@@@@BY!.               
                           ~5#@@@@@@@@@#GY?7~^::....::^~7?YG#@@@@@@@@@#5~             
                        .?B@@@@@@@&GY!:.        .YY.        .:!YG&@@@@@@@B?.          
                      .J#@@@@@@&P7:       ^    !#@@#!    ^       :7P&@@@@@@#J.        
                     7#@@@@@@#?:          5B!:5@@@@@@5:!B5          :?B@@@@@@#7       
                   :P@@@@@@B7.        .!?7B@@@@@@@@@@@@@@B7?!.         7B@@@@@@P:     
                  ~#@@@@@&J.           :JPYYYJJJJJJJJJJYYYPJ^           .?&@@@@@#~    
                 !@@@@@@B^  :!^.   ^7JY55PPGGGGBBBBBBGGGGPP55YJ7^   .~!^  ^B@@@@@@!   
                ~@@@@@@P.  Y@@@G.!B@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@B7.G@@@Y  .P@@@@@@!  
               :&@@@@@P   ?@&55!:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:!Y5&@J   P@@@@@&: 
               P@@@@@#.   #@^   ^@@&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&@@~   ^@#.  .#@@@@@P 
              ~@@@@@@!   .#@!   ^@#^:::....::::::::::::::....::::#@~   7@#.   !@@@@@@~
              5@@@@@B     G@&?. ^@#.  !7777:            ^7777!  .#@^ .J@@G     B@@@@@5
              #@@@@@Y     !@@@&?.&@^  J5YY5~     ^^     ~5YY5?  ^@&.J&@@@!     J@@@@@#
              &@@@@@7      ?&@@# P@?  !7777:   ~P@@P~   ^7777!  ?@P #@@#?      7@@@@@@
              @@@@@@7       .7&@!^&&7.       ~P@@@@@@P~       .7&&^!@&7.       7@@@@@@
              #@@@@@Y       :B@@@?^5##BPPJ :P@@@@@@@@@@P: JPPB##5~?@@@B^       J@@@@@#
              5@@@@@B      ~#&B5?G#~ ^~77^?&@@@@@@@@@@@@&?^77~^ ~#G75G&&!      B@@@@@5
              ~@@@@@@!    .7~.   ~^       5@@ #@@@@@@# @@5      ^~   .^!.     !@@@@@@~
               P@@@@@#.     .!.         P@@@@&&@@@@@@&&@@@@P         .!.     .B@@@@@P 
               :&@@@@@P  ^?P&&:        ?@@@@@@@@@@@@@@@@@@@@?        .&&G?^  P@@@@@&: 
                ~@@@@@@GB@@@@G   .     B@@@@@@@@@@@@@@@@@@@@B     .   G@@@@BG@@@@@@!  
                 !@@@@@@@@@@@Y  !B:    Y#@@@@@@@@@@@@@@@@@@#Y    :B7  Y@@@@@@@@@@@!   
                  ~#@@@@@@@@@!.5@@^     .?@@&BBBBBBBBBB&@@?.     ^@@P.!@@@@@@@@@#~    
                   :P@@@@@@@@Y#@@@! ^P.   Y@G5555555555G@Y   .P^ ~@@@#Y@@@@@@@@P:     
                     7#@@@@@@@@@@@7:#@?    G@@@@@@@@@@@@G    7@#:!@@@@@@@@@@@#7       
                      .J#@@@@@@@@@5B@@#.   .?JJJJJJJJJJ?.   .#@@#5@@@@@@@@@#J.        
                        .?B@@@@@@@@@@@@J                    J@@@@@@@@@@@@B?.          
                           ~5#@@@@@@@@@@GY?!~^::....::^~!?YG&@@@@@@@@@#5~             
                             .!YB@@@@@@@@@@@@@@&&&&&&@@@@@@@@@@@@@@BY!.               
                                 :!YG#&@@@@@@@@@@@@@@@@@@@@@@&#GY!:                   
                                     .^!?YPGB#&@@@@@@&#BGPY?!^.                     


 ^Y5J????~       ^GP7777?^       PJPG^   ^P       :GP?777?~      .JP?7777~       !B7       ~PY77777.
Y@&.  ....       J@@~^^^        .@^:@@J  7@       ?@@~^^~.       ?@@Y??7~.       G@G       &@#J??!^ 
G@&   ^?@@:      J@&^^^^        .@^  B@B 7@       7@@^^^^         :!?JJP@@.      P@G       .~7JJY&@G
 ?G5?7!?#B.      ~&B7777?7      .#.   ?&P5G       ^&B7777?7      :?77!!JBJ       ?&J       777!!7*/


// SPDX-License-Identifier: MIT
pragma solidity ^0.8.17;

import {IERC721A, ERC721A} from "erc721a/contracts/ERC721A.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/common/ERC2981.sol";
import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";
import "operator-filter-registry/src/DefaultOperatorFilterer.sol";

contract APExGenesis is ERC721A, Ownable, DefaultOperatorFilterer, ERC2981 {
    string private _baseTokenURI;
    uint256 public constant supply = 1000;
    bool public privateMint;
    bool public publicMint;
    bytes32 public merkleRoot;

    constructor() ERC721A("APEx Genesis", "APEx") {}

    function mint(bytes32[] calldata _merkleProof) external {
        require(privateMint);
        require(publicMint || verifyAddress(_merkleProof));
        require(_numberMinted(_msgSender()) == 0);
        require(totalSupply() + 1 <= supply);
        require(msg.sender == tx.origin);
        _mint(msg.sender, 1);
    }

    function adminMint(address to, uint256 quantity) external onlyOwner {
        require(totalSupply() + quantity <= supply);
        _mint(to, quantity);
    }

    function togglePrivateMint() external onlyOwner {
        privateMint = !privateMint;
    }

    function togglePublicMint() external onlyOwner {
        publicMint = !publicMint;
    }

    function setMerkleRoot(bytes32 merkleRootHash) external onlyOwner {
        merkleRoot = merkleRootHash;
    }

    function verifyAddress(
        bytes32[] calldata _merkleProof
    ) private view returns (bool) {
        bytes32 leaf = keccak256(abi.encodePacked(msg.sender));
        return MerkleProof.verify(_merkleProof, merkleRoot, leaf);
    }

    function setBaseURI(string calldata baseURI) external onlyOwner {
        _baseTokenURI = baseURI;
    }

    function _baseURI() internal view virtual override returns (string memory) {
        return _baseTokenURI;
    }

    function withdraw() external onlyOwner {
        (bool success, ) = msg.sender.call{value: address(this).balance}("");
        require(success);
    }

    function setDefaultRoyalty(
        address receiver,
        uint96 feeNumerator
    ) public onlyOwner {
        _setDefaultRoyalty(receiver, feeNumerator);
    }

    function supportsInterface(
        bytes4 interfaceId
    ) public view virtual override(ERC721A, ERC2981) returns (bool) {
        return
            ERC721A.supportsInterface(interfaceId) ||
            ERC2981.supportsInterface(interfaceId);
    }

    function setApprovalForAll(
        address operator,
        bool approved
    ) public override onlyAllowedOperatorApproval(operator) {
        super.setApprovalForAll(operator, approved);
    }

    function approve(
        address operator,
        uint256 tokenId
    ) public payable override onlyAllowedOperatorApproval(operator) {
        super.approve(operator, tokenId);
    }

    function transferFrom(
        address from,
        address to,
        uint256 tokenId
    ) public payable override onlyAllowedOperator(from) {
        super.transferFrom(from, to, tokenId);
    }

    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId
    ) public payable override onlyAllowedOperator(from) {
        super.safeTransferFrom(from, to, tokenId);
    }

    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId,
        bytes memory data
    ) public payable override onlyAllowedOperator(from) {
        super.safeTransferFrom(from, to, tokenId, data);
    }
}
